<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="theme-color" content="#ff6b6b">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Noor's Games">
    <title>Kleuren - Noor's Games</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üé®</text></svg>">
    <link rel="manifest" href="../manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            touch-action: manipulation;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            overscroll-behavior: none;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa8a8 50%, #ff8787 100%);
            font-family: 'Nunito', sans-serif;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 60px 10px 10px;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            max-width: 100%;
            width: 100%;
            text-align: center;
        }

        @media (min-width: 768px) {
            body {
                padding: 40px 20px 20px;
            }
            .game-container {
                max-width: 800px;
                padding: 20px;
                border-radius: 40px;
                height: 600px;
                overflow: auto;
            }
        }

        .back-btn {
            position: fixed;
            top: 10px;
            left: 10px;
            background: #ff9a8b;
            color: white;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 15px;
            font-family: 'Fredoka One', cursive;
            font-size: 0.9rem;
            box-shadow: 0 3px 10px rgba(0,0,0,0.15);
            transition: all 0.2s ease;
            z-index: 100;
        }

        @media (min-width: 768px) {
            .back-btn {
                top: 15px;
                left: 15px;
                padding: 10px 20px;
                font-size: 1rem;
            }
        }

        .back-btn:hover {
            background: #ff6b6b;
            transform: scale(1.05);
        }

        h1 {
            font-family: 'Fredoka One', cursive;
            color: #e63946;
            font-size: 1.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 0 #ffd5d5;
        }

        @media (min-width: 768px) {
            h1 {
                font-size: 1.8rem;
                margin-bottom: 12px;
            }
        }

        .pictures-list {
            display: flex;
            gap: 6px;
            justify-content: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        @media (min-width: 768px) {
            .pictures-list {
                gap: 8px;
                margin-bottom: 12px;
            }
        }

        .pic-btn {
            background: #fff;
            border: 2px solid #ddd;
            padding: 6px 10px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.2s ease;
        }

        @media (min-width: 768px) {
            .pic-btn {
                padding: 8px 12px;
                font-size: 1.4rem;
                border-radius: 12px;
            }
        }

        .pic-btn:hover {
            border-color: #ff6b6b;
            transform: scale(1.05);
        }

        .pic-btn.selected {
            border-color: #e63946;
            background: #fff5f5;
            box-shadow: 0 0 0 2px #ff6b6b;
        }

        .color-palette {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 5px;
            margin-bottom: 10px;
            padding: 8px;
            background: #fff5f5;
            border-radius: 12px;
        }

        @media (min-width: 768px) {
            .color-palette {
                gap: 6px;
                margin-bottom: 12px;
                padding: 10px;
                border-radius: 15px;
            }
        }

        .color-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: 2px solid white;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.15s ease;
        }

        @media (min-width: 768px) {
            .color-btn {
                width: 36px;
                height: 36px;
            }
        }

        .color-btn:hover {
            transform: scale(1.1);
        }

        .color-btn.selected {
            border-color: #333;
            transform: scale(1.15);
            box-shadow: 0 0 0 2px #333;
        }

        .canvas-container {
            background: white;
            border-radius: 12px;
            padding: 6px;
            margin-bottom: 10px;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
        }

        @media (min-width: 768px) {
            .canvas-container {
                padding: 8px;
                margin-bottom: 12px;
                border-radius: 15px;
            }
        }

        .drawing-canvas {
            width: 100%;
            height: auto;
            border-radius: 8px;
            cursor: crosshair;
            display: block;
            max-width: 100%;
        }

        @media (min-width: 768px) {
            .drawing-canvas {
                border-radius: 10px;
            }
        }

        .progress {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .toolbar {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .tool-btn {
            background: linear-gradient(180deg, #ff7675 0%, #d63031 100%);
            border: none;
            padding: 8px 16px;
            border-radius: 12px;
            font-family: 'Fredoka One', cursive;
            font-size: 0.85rem;
            color: white;
            cursor: pointer;
            box-shadow: 0 3px 0 rgba(0,0,0,0.15);
            transition: all 0.2s ease;
        }

        @media (min-width: 768px) {
            .tool-btn {
                padding: 10px 20px;
                font-size: 0.95rem;
                border-radius: 15px;
            }
        }

        .tool-btn:hover {
            transform: scale(1.05);
        }

        .tool-btn:active {
            transform: translateY(2px);
            box-shadow: 0 1px 0 rgba(0,0,0,0.15);
        }
    </style>
</head>
<body>
    <a href="../index.html" class="back-btn">üè† Terug</a>

    <div class="game-container">
        <h1>üé® Kleuren</h1>

        <div class="pictures-list">
            <button class="pic-btn selected" onclick="selectPicture('fish')">üêü</button>
            <button class="pic-btn" onclick="selectPicture('cat')">üê±</button>
            <button class="pic-btn" onclick="selectPicture('heart')">‚ù§Ô∏è</button>
            <button class="pic-btn" onclick="selectPicture('star')">‚≠ê</button>
            <button class="pic-btn" onclick="selectPicture('flower')">üå∏</button>
            <button class="pic-btn" onclick="selectPicture('sun')">‚òÄÔ∏è</button>
        </div>

        <div class="color-palette" id="palette"></div>

        <div class="canvas-container">
            <canvas id="canvas" class="drawing-canvas" width="320" height="260"></canvas>
        </div>

        <div class="progress" id="progress">0% ingekleurd</div>

        <div class="toolbar">
            <button class="tool-btn" onclick="clearCanvas()">Nieuw plaatje</button>
        </div>
    </div>

    <script>
        const colors = [
            '#FF6B6B', '#FF8E8E', '#FFB5B5', '#FFD5D5',
            '#FFE66D', '#FFA500', '#96CEB4', '#4ECDC4',
            '#45B7D1', '#74B9FF', '#A29BFE', '#DDA0DD',
            '#F0F0F0', '#A9A9A9', '#8B4513', '#2D2D2D'
        ];

        let selectedColor = colors[0];
        let currentPicture = 'fish';

        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        const outlines = {
            fish: () => {
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.ellipse(160, 130, 80, 50, 0, 0, Math.PI * 2);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(80, 130);
                ctx.lineTo(40, 90);
                ctx.lineTo(40, 170);
                ctx.closePath();
                ctx.stroke();
                ctx.beginPath();
                ctx.arc(200, 118, 12, 0, Math.PI * 2);
                ctx.stroke();
                ctx.beginPath();
                ctx.arc(202, 116, 4, 0, Math.PI * 2);
                ctx.fillStyle = '#000';
                ctx.fill();
                ctx.beginPath();
                ctx.moveTo(130, 95);
                ctx.quadraticCurveTo(160, 60, 190, 95);
                ctx.stroke();
                ctx.beginPath();
                ctx.arc(240, 140, 6, 0, Math.PI);
                ctx.stroke();
            },
            cat: () => {
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.arc(160, 140, 65, 0, Math.PI * 2);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(105, 95);
                ctx.lineTo(95, 55);
                ctx.lineTo(130, 80);
                ctx.closePath();
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(215, 95);
                ctx.lineTo(225, 55);
                ctx.lineTo(190, 80);
                ctx.closePath();
                ctx.stroke();
                ctx.beginPath();
                ctx.ellipse(138, 125, 12, 15, 0, 0, Math.PI * 2);
                ctx.stroke();
                ctx.beginPath();
                ctx.ellipse(182, 125, 12, 15, 0, 0, Math.PI * 2);
                ctx.stroke();
                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.arc(140, 125, 4, 0, Math.PI * 2);
                ctx.arc(180, 125, 4, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.moveTo(160, 150);
                ctx.lineTo(154, 160);
                ctx.lineTo(166, 160);
                ctx.closePath();
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(160, 160);
                ctx.lineTo(160, 172);
                ctx.moveTo(160, 172);
                ctx.lineTo(148, 182);
                ctx.moveTo(160, 172);
                ctx.lineTo(172, 182);
                ctx.stroke();
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(105, 155);
                ctx.lineTo(65, 150);
                ctx.moveTo(105, 162);
                ctx.lineTo(65, 162);
                ctx.moveTo(215, 155);
                ctx.lineTo(255, 150);
                ctx.moveTo(215, 162);
                ctx.lineTo(255, 162);
                ctx.stroke();
            },
            heart: () => {
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(160, 65);
                ctx.bezierCurveTo(160, 45, 120, 45, 120, 85);
                ctx.bezierCurveTo(120, 125, 160, 165, 160, 185);
                ctx.bezierCurveTo(160, 165, 200, 125, 200, 85);
                ctx.bezierCurveTo(200, 45, 160, 45, 160, 65);
                ctx.stroke();
            },
            star: () => {
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 3;
                const drawStar = (cx, cy, spikes, outerRadius, innerRadius) => {
                    let rot = Math.PI / 2 * 3;
                    let x = cx, y = cy, step = Math.PI / spikes;
                    ctx.beginPath();
                    ctx.moveTo(cx, cy - outerRadius);
                    for (let i = 0; i < spikes; i++) {
                        x = cx + Math.cos(rot) * outerRadius;
                        y = cy + Math.sin(rot) * outerRadius;
                        ctx.lineTo(x, y);
                        rot += step;
                        x = cx + Math.cos(rot) * innerRadius;
                        y = cy + Math.sin(rot) * innerRadius;
                        ctx.lineTo(x, y);
                        rot += step;
                    }
                    ctx.lineTo(cx, cy - outerRadius);
                    ctx.closePath();
                    ctx.stroke();
                };
                drawStar(160, 130, 5, 85, 42);
            },
            flower: () => {
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(160, 165);
                ctx.lineTo(160, 240);
                ctx.stroke();
                for (let i = 0; i < 6; i++) {
                    const angle = (i / 6) * Math.PI * 2;
                    const x = 160 + Math.cos(angle) * 35;
                    const y = 125 + Math.sin(angle) * 35;
                    ctx.beginPath();
                    ctx.arc(x, y, 22, 0, Math.PI * 2);
                    ctx.stroke();
                }
                ctx.beginPath();
                ctx.arc(160, 125, 18, 0, Math.PI * 2);
                ctx.stroke();
                ctx.beginPath();
                ctx.ellipse(140, 195, 15, 8, -0.5, 0, Math.PI * 2);
                ctx.stroke();
                ctx.beginPath();
                ctx.ellipse(180, 198, 15, 8, 0.5, 0, Math.PI * 2);
                ctx.stroke();
            },
            sun: () => {
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.arc(160, 140, 50, 0, Math.PI * 2);
                ctx.stroke();
                for (let i = 0; i < 8; i++) {
                    const angle = (i / 8) * Math.PI * 2;
                    const x1 = 160 + Math.cos(angle) * 60;
                    const y1 = 140 + Math.sin(angle) * 60;
                    const x2 = 160 + Math.cos(angle) * 90;
                    const y2 = 140 + Math.sin(angle) * 90;
                    ctx.beginPath();
                    ctx.moveTo(x1, y1);
                    ctx.lineTo(x2, y2);
                    ctx.stroke();
                }
            }
        };

        function initPalette() {
            const palette = document.getElementById('palette');
            palette.innerHTML = '';
            colors.forEach((color, index) => {
                const btn = document.createElement('button');
                btn.className = 'color-btn' + (index === 0 ? ' selected' : '');
                btn.style.backgroundColor = color;
                btn.onclick = () => selectColor(color, btn);
                palette.appendChild(btn);
            });
        }

        function selectColor(color, btn) {
            selectedColor = color;
            document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
        }

        function selectPicture(name) {
            currentPicture = name;
            document.querySelectorAll('.pic-btn').forEach(b => b.classList.remove('selected'));
            event.target.classList.add('selected');
            clearCanvas();
        }

        function clearCanvas() {
            ctx.fillStyle = '#fff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            outlines[currentPicture]();
            updateProgress();
        }

        function floodFill(startX, startY, fillColor) {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            
            const startPos = (startY * canvas.width + startX) * 4;
            const startR = data[startPos];
            const startG = data[startPos + 1];
            const startB = data[startPos + 2];
            
            if (startR < 60 && startG < 60 && startB < 60) return;
            
            const fillR = parseInt(fillColor.slice(1, 3), 16);
            const fillG = parseInt(fillColor.slice(3, 5), 16);
            const fillB = parseInt(fillColor.slice(5, 7), 16);
            
            if (startR === fillR && startG === fillG && startB === fillB) return;
            
            const tolerance = 50;
            
            function matches(pos) {
                const r = data[pos], g = data[pos+1], b = data[pos+2];
                return Math.abs(r - startR) <= tolerance &&
                       Math.abs(g - startG) <= tolerance &&
                       Math.abs(b - startB) <= tolerance;
            }
            
            function isBorder(pos) {
                return data[pos] < 60 && data[pos+1] < 60 && data[pos+2] < 60;
            }
            
            const stack = [[startX, startY]];
            const visited = new Set();
            const width = canvas.width;
            const height = canvas.height;
            
            while (stack.length > 0) {
                const [x, y] = stack.pop();
                const key = `${x},${y}`;
                
                if (visited.has(key)) continue;
                if (x < 0 || x >= width || y < 0 || y >= height) continue;
                
                const pos = (y * width + x) * 4;
                
                if (isBorder(pos)) continue;
                if (!matches(pos)) continue;
                
                visited.add(key);
                
                data[pos] = fillR;
                data[pos + 1] = fillG;
                data[pos + 2] = fillB;
                data[pos + 3] = 255;
                
                stack.push([x + 1, y]);
                stack.push([x - 1, y]);
                stack.push([x, y + 1]);
                stack.push([x, y - 1]);
            }
            
            ctx.putImageData(imageData, 0, 0);
            outlines[currentPicture]();
            updateProgress();
        }

        function handleClick(e) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            
            const x = Math.floor((e.clientX - rect.left) * scaleX);
            const y = Math.floor((e.clientY - rect.top) * scaleY);
            
            floodFill(x, y, selectedColor);
        }

        function updateProgress() {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const pixels = imageData.data;
            let coloredPixels = 0;
            
            for (let i = 0; i < pixels.length; i += 4) {
                if (pixels[i + 3] > 0) {
                    const r = pixels[i], g = pixels[i + 1], b = pixels[i + 2];
                    if (r !== 255 || g !== 255 || b !== 255) {
                        coloredPixels++;
                    }
                }
            }
            
            const totalPixels = canvas.width * canvas.height;
            const percent = Math.round((coloredPixels / totalPixels) * 100);
            document.getElementById('progress').textContent = percent + '% ingekleurd';
        }

        canvas.addEventListener('click', handleClick);

        initPalette();
        clearCanvas();
    </script>
</body>
</html>
